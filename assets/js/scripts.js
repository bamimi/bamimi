document.addEventListener('DOMContentLoaded', function () {
	//handle copy
	let clipboard = new ClipboardJS('.copy-button');

	clipboard.on('success', function (e) {
		e.trigger.innerHTML = '<i class="fas fa-check"></i>';
		setTimeout(function () {
			e.trigger.innerHTML = '<i class="fas fa-copy"></i>';
		}, 2000);
	});

	clipboard.on('error', function (e) {
		console.error('Copy failed', e);
	});

	//handle tabs
	const tabs = document.querySelectorAll('.btn-tab');
	const tabPanes = document.querySelectorAll('.tab-content');

	function changeTab(event) {
		tabs.forEach(tab => tab.classList.remove('active'));
		tabPanes.forEach(pane => pane.classList.remove('active'));

		event.currentTarget.classList.add('active');
		
		const targetContent = document.querySelector(`#content${event.currentTarget.id.replace('tab', '')}`);
		targetContent.classList.add('active');
	}

	tabs.forEach(tab => {
		tab.addEventListener('click', changeTab);
	});

	tabs[0].classList.add('active');
	tabPanes[0].classList.add('active');

	//handle review

	const templateHandleBox = `
		<div class="review-box mb-4">
			<p class="review-msg">"-Message-"</p>
			<div class="review-person">
				<img class="review-avatar" src="-imageUrl-"/>
				<div class="review-person-info">
					<span class="review-person-name">-nameReviewer-</span>
					<span class="review-person-job">-jobReviewer-</span>
				</div>
			</div>
		</div>`
	function loadReviews() {
		const dataUrl = `assets/data/review.json`;

		fetch(dataUrl)
			.then(async (response) => {
				if (response.ok) {
					
					return response.json();
				} else {
					throw new Error('File not found');
				}
			})
			.then(reviews => {
				let reviewRender = ""
				for (const review of reviews) {
					let rvElement = templateHandleBox;
					rvElement = rvElement.replace("-Message-", review.msg)
					rvElement = rvElement.replace("-imageUrl-", review.imageUrl)
					rvElement = rvElement.replace("-nameReviewer-", review.name)
					rvElement = rvElement.replace("-jobReviewer-", review.job)

					reviewRender += rvElement
				}
				document.getElementById("reviewList").innerHTML = reviewRender
			})
			.catch(error => {
				
			})
			.finally(() => {
				
			});
	}

	loadReviews()

	function renderCodeInMoreEfficient() {
		const htmlSecurity = `<form id="quickForm" method="POST">
	<%- global.$_csrf.input(csrfToken) %>
	<input type="text" name="username">
	<button type="submit">Save</button>
</form>
`
		const htmlEmail = `<!-- @isNotifications/email/demoEmail.ejs -->
<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Demo</title>
</head>

<body>
	<div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
		<h2 style="color: black;">Welcome</h2>
		<p>Template is generated by Bamimi</p>
	</div>
</body>

</html>
`

		document.getElementById('html-code').textContent = htmlSecurity
		document.getElementById('email-template-code').textContent = htmlEmail

	}

	renderCodeInMoreEfficient()
});


